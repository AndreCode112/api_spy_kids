<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitor de Logs - SpyKids</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'videos/css/style_logs.css' %}">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/svg+xml" href="{% static 'videos/svg/logo.svg' %}">
    <script src="https://unpkg.com/lucide@latest"></script>
   
</head>
<body class="bg-slate-50 text-slate-800 h-screen flex flex-col overflow-hidden">

    <header class="bg-white border-b border-slate-200 px-6 py-4 flex flex-col md:flex-row justify-between items-center shadow-sm z-20 gap-4 md:gap-0">
        
        <div class="flex items-center gap-3 w-full md:w-auto">
            <div class="p-2 bg-slate-800 rounded-lg text-white shadow-lg shadow-slate-300/50">
                <i data-lucide="terminal-square" class="w-5 h-5"></i>
            </div>
            <div>
                <h1 class="text-lg font-bold text-slate-800 leading-tight">System Logs - SpyKids</h1>
                <p class="text-xs text-slate-400 font-medium">Monitoramento em Tempo Real os logs da aplicação SpyKids</p>
            </div>
        </div>
        
        <div class="flex flex-wrap items-center gap-3 w-full md:w-auto justify-end">
            
            <div class="flex items-center gap-2 bg-slate-100 rounded-lg px-3 py-2 border border-transparent hover:border-slate-300 transition-colors">
                <span class="text-xs text-slate-400 font-semibold uppercase tracking-wider">Exibir:</span>
                <select id="limitFilter" class="bg-transparent text-sm text-slate-700 font-bold focus:outline-none cursor-pointer">
                    <option value="50">50</option>
                    <option value="100" selected>100</option>
                    <option value="500">500</option>
                    <option value="1000">1k</option>
                    <option value="all">Tudo</option>
                </select>
            </div>

            <div class="h-6 w-px bg-slate-200 mx-1 hidden md:block"></div>

            <div class="relative flex-grow md:flex-grow-0">
                <i data-lucide="search" class="w-4 h-4 absolute left-3 top-2.5 text-slate-400"></i>
                <input type="text" id="searchInput" placeholder="Buscar erro ou ID..." 
                    class="pl-9 pr-4 py-2 bg-slate-100 border border-transparent focus:bg-white focus:border-slate-300 rounded-lg text-sm text-slate-700 placeholder-slate-400 focus:ring-2 focus:ring-slate-100 outline-none w-full md:w-64 transition-all">
            </div>

            <select id="clientFilter" class="px-3 py-2 bg-slate-100 border border-transparent hover:bg-slate-200 rounded-lg text-sm text-slate-700 font-medium focus:ring-2 focus:ring-slate-100 outline-none cursor-pointer transition-colors">
                <option value="all">Todas as Origens</option>
                <option value="server">Server</option>
                <option value="app">App</option>
                <option value="server_ftp">Server_ftp</option>
            </select>
            
            <button onclick="fetchLogs()" class="p-2 bg-slate-800 text-white rounded-lg hover:bg-slate-700 active:scale-95 transition-all shadow-md shadow-slate-300 hover:shadow-lg" title="Atualizar Lista">
                <i id="refreshIcon" data-lucide="refresh-cw" class="w-4 h-4"></i>
            </button>
        </div>
    </header>

    <main class="flex-1 overflow-y-auto p-4 md:p-6 relative bg-slate-50/50">
        
        <div id="loader" class="hidden absolute inset-0 flex flex-col justify-center items-center bg-slate-50/80 z-10 backdrop-blur-sm">
            <div class="animate-spin text-slate-800 mb-3">
                <i data-lucide="loader-2" class="w-8 h-8"></i>
            </div>
            <p class="text-sm text-slate-500 font-medium animate-pulse">Carregando dados...</p>
        </div>

        <div id="logsContainer" class="space-y-3 max-w-5xl mx-auto pb-10 transition-opacity duration-200">
            </div>

        <div id="emptyState" class="hidden flex flex-col items-center justify-center h-full min-h-[300px] text-slate-400">
            <div class="bg-white p-4 rounded-full shadow-sm mb-4">
                <i data-lucide="inbox" class="w-8 h-8 text-slate-300"></i>
            </div>
            <h3 class="text-slate-600 font-semibold text-lg">Nenhum log encontrado</h3>
            <p class="text-sm">Tente ajustar seus filtros ou a busca.</p>
        </div>

    </main>

    <div id="detailModal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm hidden flex items-center justify-center z-50 opacity-0 transition-opacity duration-300" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-3xl transform scale-95 transition-all duration-300 p-0 m-4 overflow-hidden flex flex-col max-h-[80vh]">
            
            <div class="bg-slate-50 border-b border-slate-100 px-6 py-4 flex justify-between items-center">
                <div class="flex items-center gap-2">
                    <i data-lucide="alert-triangle" class="w-5 h-5 text-red-500"></i>
                    <h3 class="text-lg font-bold text-slate-800">Detalhes da Exceção</h3>
                </div>
                <button onclick="closeModal()" class="text-slate-400 hover:text-slate-600 hover:bg-slate-200 rounded-lg p-1 transition-colors">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>

            <div class="p-6 overflow-y-auto">
                <div class="mb-4 flex gap-4 text-sm text-slate-500">
                    <div>
                        <span class="font-bold text-slate-700">Origem:</span>
                        <span id="modalClient" class="ml-1 px-2 py-0.5 rounded text-xs font-bold text-white bg-slate-500">SERVER</span>
                    </div>
                    <div>
                        <span class="font-bold text-slate-700">Data:</span>
                        <span id="modalDate">12/12/2024 14:30</span>
                    </div>
                </div>

                <div class="relative group">
                    <pre id="modalContent" class="bg-slate-900 text-slate-50 p-4 rounded-lg font-mono text-sm leading-relaxed overflow-x-auto whitespace-pre-wrap border border-slate-700 shadow-inner select-all"></pre>
                    <span class="absolute top-2 right-2 text-[10px] text-slate-500 opacity-0 group-hover:opacity-100 transition-opacity">raw log</span>
                </div>
            </div>

            <div class="bg-slate-50 px-6 py-4 border-t border-slate-100 flex justify-end">
                <button onclick="closeModal()" class="px-5 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 hover:border-slate-400 transition-all font-medium text-sm shadow-sm">
                    Fechar
                </button>
            </div>
        </div>
    </div>
</body>

<script src="{% static 'videos/js/script6.js' %}"></script>
    
</html>